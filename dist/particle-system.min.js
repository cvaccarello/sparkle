"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),Particle=function(){function t(e,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;_classCallCheck(this,t),this._settings=$.extend(!0,{append_to:$("body"),template:'<div style="width: 5px; height: 5px; background-color: red; z-index: 2;"></div>',time_to_live:2e3,speed_amt:10,size_amt:0,size:10},s),a||(this.$element=$(this._settings.template).css("visibility","hidden"),this.$element.appendTo(this._settings.append_to),this.width=this.$element.width(),this.height=this.$element.height());var h=this.$element?this.$element.offsetParent().offset():this._settings.append_to.offset();this.coordinates={x:e.x-h.left,y:e.y-h.top},this.size_amt=this._settings.size_amt,this.speed_amt=this._settings.speed_amt,this._debug=n,this._vx=this.speed_amt*Math.cos(i),this._vy=this.speed_amt*-Math.sin(i),this._ttl=this._settings.time_to_live,this.ctx=a,this.size=this._settings.size,a||this.$element.css({position:"absolute",visibility:"visible"}),this._render()}return _createClass(t,[{key:"update",value:function(t){this.reduceTTL(t),this.move(t),this.width+=this.size_amt*t,this.height+=this.size_amt*t,this._render()}},{key:"reduceTTL",value:function(t){this._ttl-=t}},{key:"move",value:function(t){this.coordinates.x+=this._vx*t,this.coordinates.y+=this._vy*t}},{key:"remove",value:function(){this.$element&&this.$element.remove()}},{key:"_render",value:function(){this.ctx?(this.ctx.fillStyle=this._settings.append_to.css("color"),this.ctx.beginPath(),this.ctx.arc(this.coordinates.x,this.coordinates.y,this.size,0,2*Math.PI),this.ctx.closePath(),this.ctx.fill()):this.$element&&this.$element.css({top:0,left:0,transform:"translate("+(this.coordinates.x-this.height/2)+"px, "+(this.coordinates.y-this.width/2)+"px)",width:this.width+"px",height:this.height+"px"})}},{key:"TTL",get:function(){return this._ttl}}]),t}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),ParticleEmitter=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_classCallCheck(this,t);var s=-Math.PI/180;this._settings=$.extend(!0,{active:!1,element:$("body"),max_particles:100,emit_delay:{min:100,max:100},direction:{min:0,max:360},spawn_point:"center",particle:{constructor:Particle,append_to:$("body"),template:'<div style="width: 5px; height: 5px; background-color: red; z-index: 2;"></div>',time_to_live:2e3,speed_amt:70,size_amt:0,size:10}},e),this.particles=[],this.$element=this._settings.element,this.width=this.$element.outerWidth(),this.height=this.$element.outerHeight(),this.ctx=null,this.$element.is("canvas")&&(this.ctx=this.$element[0].getContext("2d"),this._settings.particle.append_to=this.$element),this._debug=i,this._active=this._settings.active,this._destroyed=!1,this._triggerCallback=null,this._spawn_position={},this._delay=0,this._time=new Date,this._elapsed_time=this._time.getTime(),"object"==_typeof(this._settings.direction)?(this._settings.direction.min=(this._settings.direction.min-90)*s,this._settings.direction.max=(this._settings.direction.max-90)*s):"in"==this._settings.direction&&"outside"==this._settings.spawn_point?(this.left={min:90*s,max:270*s},this.right={min:-90*s,max:270*s},this.up={min:-180*s,max:0*s},this.down={min:0*s,max:180*s}):(this._settings.direction.min=-90*s,this._settings.direction.max=270*s),this._settings.particle.speed_amt>0&&(this._settings.particle.speed_amt/=1e3),this._settings.particle.size_amt>0&&(this._settings.particle.size_amt/=1e3),this._spawn_position={x:"center"==this._settings.spawn_point?this.width/2:0,y:"center"==this._settings.spawn_point?this.height/2:0}}return _createClass(t,[{key:"update",value:function(){var t=new Date;this._elapsed_time=t-this._time,this._elapsed_time>500&&(this._debug&&console.log("Particle System: Capping elapsed time at 500 (was "+this._elapsed_time+")"),this._elapsed_time=500),this._active&&this._createParticles(this._elapsed_time),this._updateParticles(this._elapsed_time),this._time=(new Date).getTime()}},{key:"addParticle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=0,s=360;e||"object"!=_typeof(this._settings.direction)?(e||"top"!==t.location||(s=this.down.max,i=this.down.min),e||"bottom"!==t.location||(s=this.up.max,i=this.up.min),e||"left"!==t.location||(s=this.right.max,i=this.right.min),e||"right"!==t.location||(s=this.left.max,i=this.left.min)):(s=this._settings.direction.max,i=this._settings.direction.min),e||(e=Math.random()*(s-i)+i),this.particles.push(new this._settings.particle.constructor(t,e,this._settings.particle,this._debug,this.ctx))}},{key:"trigger",value:function(t,e){var i=this;this._active=!0,this._triggerCallback=window.setTimeout(function(){i._active=!1,e&&e.call()},t)}},{key:"toggle",value:function(){this._active=!this._active,this._triggerCallback&&window.clearTimeout(this._triggerCallback)}},{key:"activate",value:function(){this._active=!0}},{key:"deactivate",value:function(){this._active=!1}},{key:"remove",value:function(){this._destroyed=!0;for(var t=0;t<this.particles.length;t++)this.particles[t].remove(),this.particles.splice(t,1),t--}},{key:"_updateParticles",value:function(t){this.ctx&&this.ctx.clearRect(0,0,this.width,this.height);for(var e=0;e<this.particles.length;e++){var i=this.particles[e];i.update(t),i.TTL<=0&&(i.remove(),this.particles.splice(e,1),e--)}}},{key:"_createParticles",value:function(t){var e=this.particleSpawnPosition,i=this._settings.emit_delay,s=i.min||i.max?Math.random()*(i.max-i.min)+i.min:i;if(this.particles.length<this._settings.max_particles)for(this._delay-=this._elapsed_time;this._delay<=0&&this.particles.length<this._settings.max_particles;)this._delay+=s,this.addParticle(e)}},{key:"particleSpawnPosition",get:function(){var t=this.$element.offset(),e={x:t.left+this._spawn_position.x,y:t.top+this._spawn_position.y};return"random"==this._settings.spawn_point?(e.x+=Math.random()*this.width,e.y+=Math.random()*this.height):"outside"==this._settings.spawn_point&&(Math.round(Math.random())?(e.x+=Math.random()*this.width,Math.round(Math.random())?(e.y+=this.height,e.location="bottom"):e.location="top"):(e.y+=Math.random()*this.height,Math.round(Math.random())?(e.x+=this.width,e.location="right"):e.location="left")),e}},{key:"isDestroyed",get:function(){return this._destroyed}}]),t}(),_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),ParticleSystem=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_classCallCheck(this,t),this._settings=$.extend(!0,{timeout:30},i),this._debug=s,this._particle_emitters=[],requestAnimationFrame){var n=function a(){window.setTimeout(function(){e._update(),requestAnimationFrame(a)},e._settings.timeout)};n()}else window.setInterval(function(){e._update()},this._settings.timeout)}return _createClass(t,[{key:"addEmitter",value:function(t){return this._particle_emitters.push(t),t}},{key:"removeEmitter",value:function(t){for(var e=0;e<this._particle_emitters.length;e++)if(t==this._particle_emitters[e]){this._particle_emitters[e].remove(),this._particle_emitters.splice(e,1);break}}},{key:"_update",value:function(){for(var t=0;t<this._particle_emitters.length;t++){var e=this._particle_emitters[t];e.isDestroyed?(this._particle_emitters.splice(t,1),t--):e.update()}}}]),t}();
//# sourceMappingURL=particle-system.min.js.map
